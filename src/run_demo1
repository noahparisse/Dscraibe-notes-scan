# Ce fichier orchestre les différents porcessus nécessaires à la démonstration de la v0 du vendredi 3 octobre

import subprocess
import os
import time

try:
    BASE_DIR = os.path.dirname(os.path.abspath(__file__))

    watcher_path = os.path.join(BASE_DIR, "watch/watch_images.py")
    streamlit_path = os.path.join(BASE_DIR, "frontend/app_streamlit.py")
    yolo_path = os.path.join(BASE_DIR, "./proc/paper_detection/yolo_tracker_with_deblurring.py")

    watcher_process = subprocess.Popen(["Python3", watcher_path])
    streamlit_process = subprocess.Popen(["Python3", streamlit_path])
    yolo_process = subprocess.Popen(["Python3", yolo_path])

    print("Tous les process ont été lancés.")
    print("Le système est en train de numériser les notes.")
    while True:
        time.sleep(1)
finally:
    watcher_process.terminate()
    streamlit_process.terminate()
    yolo_process.terminate()
    print("Tous les processus ont été terminés.")